∆E
PC:\Asp.netCore\TodoApi\TodoApi.WebApi\TodoApi\Controllers\TodoItemsController.cs
	namespace

 	
TodoApi


 
.

 
Controllers

 
{ 
[ 
Produces 
( 
$str  
)  !
]! "
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
public 

class 
TodoItemsController $
:% &
ControllerBase' 5
{ 
private 
readonly 
TodoContext $
_context% -
;- .
public 
TodoItemsController "
(" #
TodoContext# .
context/ 6
)6 7
{ 	
_context 
= 
context 
; 
} 	
[ 	
HttpGet	 
] 
public 
async 
Task 
< 
ActionResult &
<& '
IEnumerable' 2
<2 3
TodoItemDTO3 >
>> ?
>? @
>@ A
GetTodoItemsB N
(N O
)O P
{ 	
return 
await 
_context !
.! "
	TodoItems" +
. 
Select 
( 
x 
=> 
	ItemToDTO &
(& '
x' (
)( )
)) *
. 
ToListAsync 
( 
) 
; 
} 	
["" 	
HttpGet""	 
("" 
$str"" 
,"" 
Name"" 
="" 
$str""  )
)"") *
]""* +
public## 
async## 
Task## 
<## 
ActionResult## &
<##& '
TodoItemDTO##' 2
>##2 3
>##3 4
GetTodoItem##5 @
(##@ A
long##A E
id##F H
)##H I
{$$ 	
var%% 
todoItem%% 
=%% 
await%%  
_context%%! )
.%%) *
	TodoItems%%* 3
.%%3 4
	FindAsync%%4 =
(%%= >
id%%> @
)%%@ A
;%%A B
if'' 
('' 
todoItem'' 
=='' 
null''  
)''  !
{(( 
return)) 
NotFound)) 
())  
)))  !
;))! "
}** 
return,, 
	ItemToDTO,, 
(,, 
todoItem,, %
),,% &
;,,& '
}-- 	
[00 	
HttpPut00	 
(00 
$str00 
)00 
]00 
public11 
async11 
Task11 
<11 
IActionResult11 '
>11' (
UpdateTodoItem11) 7
(117 8
long118 <
id11= ?
,11? @
TodoItemDTO11A L
todoItemDto11M X
)11X Y
{22 	
if33 
(33 
id33 
!=33 
todoItemDto33 !
.33! "
Id33" $
)33$ %
{44 
return55 

BadRequest55 !
(55! "
)55" #
;55# $
}66 
TodoItem88 
todoItem88 
=88 
await88  %
_context88& .
.88. /
	TodoItems88/ 8
.888 9
	FindAsync889 B
(88B C
id88C E
)88E F
;88F G
if99 
(99 
todoItem99 
==99 
null99  
)99  !
{:: 
return;; 
NotFound;; 
(;;  
);;  !
;;;! "
}<< 
todoItem>> 
.>> 
Name>> 
=>> 
todoItemDto>> '
.>>' (
Name>>( ,
;>>, -
todoItem?? 
.?? 

IsComplete?? 
=??  !
todoItemDto??" -
.??- .

IsComplete??. 8
;??8 9
try@@ 
{AA 
awaitBB 
_contextBB 
.BB 
SaveChangesAsyncBB /
(BB/ 0
)BB0 1
;BB1 2
}CC 
catchDD 
(DD (
DbUpdateConcurrencyExceptionDD /
)DD/ 0
whenDD1 5
(DD6 7
!DD7 8
TodoItemExistsDD8 F
(DDF G
idDDG I
)DDI J
)DDJ K
{EE 
returnFF 
NotFoundFF 
(FF  
)FF  !
;FF! "
}GG 
catchHH 
(HH 
DbUpdateExceptionHH $
)HH$ %
{II 
returnJJ 
ConflictJJ 
(JJ  
)JJ  !
;JJ! "
}KK 
returnLL 
	NoContentLL 
(LL 
)LL 
;LL 
}MM 	
[`` 	
HttpPost``	 
]`` 
[aa 	 
ProducesResponseTypeaa	 
(aa 
StatusCodesaa )
.aa) *
Status201Createdaa* :
)aa: ;
]aa; <
[bb 	 
ProducesResponseTypebb	 
(bb 
StatusCodesbb )
.bb) *
Status400BadRequestbb* =
)bb= >
]bb> ?
publiccc 
asynccc 
Taskcc 
<cc 
ActionResultcc &
<cc& '
TodoItemDTOcc' 2
>cc2 3
>cc3 4
CreateTodoItemcc5 C
(ccC D
TodoItemDTOccD O
todoItemDtoccP [
)cc[ \
{dd 	
varee 
todoItemee 
=ee 
newee 
TodoItemee '
{ff 

IsCompletegg 
=gg 
todoItemDtogg (
.gg( )

IsCompletegg) 3
,gg3 4
Namehh 
=hh 
todoItemDtohh "
.hh" #
Namehh# '
}ii 
;ii 
_contextjj 
.jj 
	TodoItemsjj 
.jj 
Addjj "
(jj" #
todoItemjj# +
)jj+ ,
;jj, -
awaitkk 
_contextkk 
.kk 
SaveChangesAsynckk +
(kk+ ,
)kk, -
;kk- .
returnmm 
CreatedAtActionmm "
(mm" #
nameofnn 
(nn 
GetTodoItemnn "
)nn" #
,nn# $
newoo 
{oo 
idoo 
=oo 
todoItemoo #
.oo# $
Idoo$ &
}oo' (
,oo( )
	ItemToDTOpp 
(pp 
todoItempp "
)pp" #
)pp# $
;pp$ %
}qq 	
[tt 	

HttpDeletett	 
(tt 
$strtt 
)tt 
]tt 
publicuu 
asyncuu 
Taskuu 
<uu 
ActionResultuu &
<uu& '
TodoItemuu' /
>uu/ 0
>uu0 1
DeleteTodoItemuu2 @
(uu@ A
longuuA E
iduuF H
)uuH I
{vv 	
varww 
todoItemww 
=ww 
awaitww  
_contextww! )
.ww) *
	TodoItemsww* 3
.ww3 4
	FindAsyncww4 =
(ww= >
idww> @
)ww@ A
;wwA B
ifxx 
(xx 
todoItemxx 
==xx 
nullxx  
)xx  !
{yy 
returnzz 
NotFoundzz 
(zz  
)zz  !
;zz! "
}{{ 
_context}} 
.}} 
	TodoItems}} 
.}} 
Remove}} %
(}}% &
todoItem}}& .
)}}. /
;}}/ 0
await~~ 
_context~~ 
.~~ 
SaveChangesAsync~~ +
(~~+ ,
)~~, -
;~~- .
return
ÄÄ 
todoItem
ÄÄ 
;
ÄÄ 
}
ÅÅ 	
private
ÉÉ 
bool
ÉÉ 
TodoItemExists
ÉÉ #
(
ÉÉ# $
long
ÉÉ$ (
id
ÉÉ) +
)
ÉÉ+ ,
{
ÑÑ 	
return
ÖÖ 
_context
ÖÖ 
.
ÖÖ 
	TodoItems
ÖÖ %
.
ÖÖ% &
Any
ÖÖ& )
(
ÖÖ) *
e
ÖÖ* +
=>
ÖÖ, .
e
ÖÖ/ 0
.
ÖÖ0 1
Id
ÖÖ1 3
==
ÖÖ4 6
id
ÖÖ7 9
)
ÖÖ9 :
;
ÖÖ: ;
}
ÜÜ 	
private
àà 
static
àà 
TodoItemDTO
àà "
	ItemToDTO
àà# ,
(
àà, -
TodoItem
àà- 5
todoItem
àà6 >
)
àà> ?
=>
àà@ B
new
ààC F
TodoItemDTO
ààG R
{
ââ 	
Id
ää 
=
ää 
todoItem
ää 
.
ää 
Id
ää 
,
ää 
Name
ãã 
=
ãã 
todoItem
ãã 
.
ãã 
Name
ãã  
,
ãã  !

IsComplete
åå 
=
åå 
todoItem
åå !
.
åå! "

IsComplete
åå" ,
}
çç 	
;
çç	 

}
éé 
}èè ê
CC:\Asp.netCore\TodoApi\TodoApi.WebApi\TodoApi\Models\TodoContext.cs
	namespace 	
TodoApi
 
. 
Models 
{ 
public		 

class		 
TodoContext		 
:		 
	DbContext		 (
{

 
public 
TodoContext 
( 
DbContextOptions +
<+ ,
TodoContext, 7
>7 8
options9 @
)@ A
:B C
baseD H
(H I
optionsI P
)P Q
{ 	
} 	
public 
TodoContext 
( 
) 
{ 	
} 	
public 
DbSet 
< 
TodoItem 
> 
	TodoItems (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
} 
} Ê
@C:\Asp.netCore\TodoApi\TodoApi.WebApi\TodoApi\Models\TodoItem.cs
	namespace 	
TodoApi
 
. 
Models 
{ 
public 

class 
TodoItem 
{		 
public

 
long

 
Id

 
{

 
get

 
;

 
set

 !
;

! "
}

# $
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
public 
bool 

IsComplete 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
Secret 
{ 
get "
;" #
set$ '
;' (
}) *
} 
} “
CC:\Asp.netCore\TodoApi\TodoApi.WebApi\TodoApi\Models\TodoItemDTO.cs
	namespace 	
TodoApi
 
. 
Models 
{ 
public 

class 
TodoItemDTO 
{		 
public

 
long

 
Id

 
{

 
get

 
;

 
set

 !
;

! "
}

# $
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
public 
bool 

IsComplete 
{  
get! $
;$ %
set& )
;) *
}+ ,
} 
} ç

8C:\Asp.netCore\TodoApi\TodoApi.WebApi\TodoApi\Program.cs
	namespace

 	
TodoApi


 
{ 
public 

class 
Program 
{ 
public 
static 
void 
Main 
(  
string  &
[& '
]' (
args) -
)- .
{ 	
CreateHostBuilder 
( 
args "
)" #
.# $
Build$ )
() *
)* +
.+ ,
Run, /
(/ 0
)0 1
;1 2
} 	
public 
static 
IHostBuilder "
CreateHostBuilder# 4
(4 5
string5 ;
[; <
]< =
args> B
)B C
=>D F
Host 
.  
CreateDefaultBuilder %
(% &
args& *
)* +
. $
ConfigureWebHostDefaults )
() *

webBuilder* 4
=>5 7
{ 

webBuilder 
. 

UseStartup )
<) *
Startup* 1
>1 2
(2 3
)3 4
;4 5
} 
) 
; 
} 
} æ'
8C:\Asp.netCore\TodoApi\TodoApi.WebApi\TodoApi\Startup.cs
	namespace 	
TodoApi
 
{ 
public 

class 
Startup 
{ 
public 
Startup 
( 
IConfiguration %
configuration& 3
)3 4
{ 	
Configuration 
= 
configuration )
;) *
} 	
public 
IConfiguration 
Configuration +
{, -
get. 1
;1 2
}3 4
public 
void 
ConfigureServices %
(% &
IServiceCollection& 8
services9 A
)A B
{ 	
services 
. 
AddDbContext !
<! "
TodoContext" -
>- .
(. /
opt/ 2
=>3 5
opt 
. 
UseInMemoryDatabase '
(' (
$str( 2
)2 3
)3 4
;4 5
services 
. 
AddControllers #
(# $
)$ %
;% &
services 
. 
AddSwaggerGen "
(" #
c# $
=>% '
{ 
c   
.   

SwaggerDoc   
(   
$str   !
,  ! "
new  # &
OpenApiInfo  ' 2
{!! 
Version"" 
="" 
$str"" "
,""" #
Title## 
=## 
$str## &
,##& '
Description$$ 
=$$  !
$str$$" I
,$$I J
TermsOfService%% "
=%%# $
new%%% (
Uri%%) ,
(%%, -
$str%%- H
)%%H I
,%%I J
Contact&& 
=&& 
new&& !
OpenApiContact&&" 0
{'' 
Name(( 
=(( 
$str(( -
,((- .
Email)) 
=)) 
string))  &
.))& '
Empty))' ,
,)), -
Url** 
=** 
new** !
Uri**" %
(**% &
$str**& C
)**C D
,**D E
}++ 
,++ 
License,, 
=,, 
new,, !
OpenApiLicense,," 0
{-- 
Name.. 
=.. 
$str.. /
,../ 0
Url// 
=// 
new// !
Uri//" %
(//% &
$str//& C
)//C D
,//D E
}00 
}11 
)11 
;11 
var33 
xmlFile33 
=33 
$"33  
{33  !
Assembly33! )
.33) * 
GetExecutingAssembly33* >
(33> ?
)33? @
.33@ A
GetName33A H
(33H I
)33I J
.33J K
Name33K O
}33O P
.xml33P T
"33T U
;33U V
var44 
xmlPath44 
=44 
Path44 "
.44" #
Combine44# *
(44* +

AppContext44+ 5
.445 6
BaseDirectory446 C
,44C D
xmlFile44E L
)44L M
;44M N
c55 
.55 
IncludeXmlComments55 $
(55$ %
xmlPath55% ,
)55, -
;55- .
}66 
)66 
;66 
}77 	
public:: 
void:: 
	Configure:: 
(:: 
IApplicationBuilder:: 1
app::2 5
,::5 6
IWebHostEnvironment::7 J
env::K N
)::N O
{;; 	
if<< 
(<< 
env<< 
.<< 
IsDevelopment<< !
(<<! "
)<<" #
)<<# $
{== 
app>> 
.>> %
UseDeveloperExceptionPage>> -
(>>- .
)>>. /
;>>/ 0
}?? 
appAA 
.AA 
UseHttpsRedirectionAA #
(AA# $
)AA$ %
;AA% &
appCC 
.CC 

UseSwaggerCC 
(CC 
)CC 
;CC 
appEE 
.EE 
UseSwaggerUIEE 
(EE 
cEE 
=>EE !
{FF 
cGG 
.GG 
SwaggerEndpointGG !
(GG! "
$strGG" <
,GG< =
$strGG> I
)GGI J
;GGJ K
cHH 
.HH 
RoutePrefixHH 
=HH 
stringHH  &
.HH& '
EmptyHH' ,
;HH, -
}II 
)II 
;II 
appKK 
.KK 

UseRoutingKK 
(KK 
)KK 
;KK 
appMM 
.MM 
UseAuthorizationMM  
(MM  !
)MM! "
;MM" #
appOO 
.OO 
UseEndpointsOO 
(OO 
	endpointsOO &
=>OO' )
{PP 
	endpointsQQ 
.QQ 
MapControllersQQ (
(QQ( )
)QQ) *
;QQ* +
}RR 
)RR 
;RR 
}SS 	
}TT 
}UU 